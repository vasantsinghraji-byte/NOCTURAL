<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add security headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self' http://localhost:5000;">
    <meta name="description" content="Noctural - A modern healthcare staffing platform connecting professionals with facilities">
    <meta name="keywords" content="healthcare, staffing, medical professionals, nurses, doctors">
    <meta name="robots" content="index, follow">
    <title>Noctural - Healthcare Staffing Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #5B8DBE;
            --primary-dark: #4A7099;
            --secondary: #7B68B8;
            --accent: #9B8FC7;
            --success: #28a745;
            --danger: #dc3545;
            --text-dark: #2C3E50;
            --text-light: #6C757D;
            --bg-light: #F8F9FA;
            --gradient-bg: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 50%, #D1C4E9 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Navigation */
        nav {
            background: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            font-size: 2rem;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 15px rgba(91, 141, 190, 0.3);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(91, 141, 190, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background: #6A5AA1;
        }

        /* Hero Section */
        .hero {
            background: var(--gradient-bg);
            padding: 100px 40px;
            text-align: center;
        }

        .hero-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 30px;
            font-weight: 700;
            line-height: 1.2;
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 50px auto;
            max-width: 1000px;
            text-align: left;
        }

        .benefits-column h3 {
            color: var(--text-dark);
            font-size: 1.3rem;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .benefits-column ul {
            list-style: none;
        }

        .benefits-column li {
            padding: 12px 0;
            color: var(--text-dark);
            font-size: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .benefits-column li::before {
            content: "‚Ä¢";
            color: var(--primary);
            font-size: 1.5rem;
            font-weight: bold;
            flex-shrink: 0;
        }

        .mission-statement {
            max-width: 900px;
            margin: 60px auto 40px;
            padding: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .mission-statement p {
            font-size: 1.1rem;
            color: var(--text-dark);
            margin-bottom: 15px;
            line-height: 1.8;
        }

        .mission-statement p:last-child {
            font-weight: 600;
            color: var(--primary);
        }

        .cta-button {
            margin-top: 30px;
        }

        /* How It Works Section */
        .how-it-works {
            padding: 80px 40px;
            background: white;
        }

        .how-it-works h2 {
            text-align: center;
            font-size: 2.5rem;
            color: var(--text-dark);
            margin-bottom: 60px;
            font-weight: 700;
        }

        .steps-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 40px;
        }

        .step {
            text-align: center;
            padding: 20px;
        }

        .step-icon {
            width: 120px;
            height: 120px;
            margin: 0 auto 25px;
            background: var(--gradient-bg);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .step:hover .step-icon {
            transform: translateY(-10px);
        }

        .step h3 {
            font-size: 1.2rem;
            color: var(--text-dark);
            margin-bottom: 15px;
            font-weight: 600;
        }

        .step p {
            color: var(--text-light);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* Features Section */
        .features {
            padding: 80px 40px;
            background: var(--bg-light);
        }

        .features-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .feature-block {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
            margin-bottom: 60px;
        }

        .feature-content h3 {
            font-size: 1.8rem;
            color: var(--text-dark);
            margin-bottom: 20px;
            font-weight: 700;
        }

        .feature-content p {
            font-size: 1.05rem;
            color: var(--text-dark);
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .feature-content .highlight {
            font-weight: 600;
            color: var(--primary);
        }

        .feature-visual {
            background: var(--gradient-bg);
            border-radius: 20px;
            padding: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .feature-visual-content {
            font-size: 8rem;
            text-align: center;
        }

        .quote-section {
            text-align: center;
            padding: 60px 40px;
            background: white;
            margin: 40px 0;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .quote-section h2 {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 20px;
            font-weight: 600;
            font-style: italic;
        }

        .quote-section p {
            color: var(--text-light);
            font-size: 1.1rem;
        }

        /* Get Started Section */
        .get-started {
            padding: 100px 40px;
            background: var(--gradient-bg);
            text-align: center;
        }

        .get-started-content {
            max-width: 900px;
            margin: 0 auto;
        }

        .get-started h2 {
            font-size: 2.5rem;
            color: var(--text-dark);
            margin-bottom: 30px;
            font-weight: 700;
        }

        .get-started p {
            font-size: 1.1rem;
            color: var(--text-dark);
            margin-bottom: 20px;
            line-height: 1.8;
        }

        .get-started .requirements {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 40px 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .get-started .requirements p {
            font-size: 1rem;
        }

        .get-started .bold-text {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.3rem;
            margin: 30px 0;
        }

        /* Footer */
        footer {
            background: white;
            padding: 40px;
            text-align: center;
            border-top: 1px solid #E0E0E0;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--primary-dark);
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .social-links a {
            font-size: 1.5rem;
            color: var(--text-light);
            transition: color 0.3s ease;
        }

        .social-links a:hover {
            color: var(--primary);
        }

        footer p {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            backdrop-filter: blur(5px);
            overflow-y: auto;
        }

        .modal-content {
            position: relative;
            background: white;
            max-width: 500px;
            margin: 50px auto;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlide 0.3s ease;
        }

        @keyframes modalSlide {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2rem;
            cursor: pointer;
            color: var(--text-light);
            background: none;
            border: none;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: var(--text-dark);
        }

        .modal-content h2 {
            color: var(--primary);
            margin-bottom: 30px;
            font-size: 2rem;
            font-weight: 700;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.95rem;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #E0E0E0;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(91, 141, 190, 0.1);
        }

        .modal-content button[type="submit"] {
            width: 100%;
            padding: 15px;
            margin-top: 10px;
        }

        .modal-footer {
            text-align: center;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #E0E0E0;
        }

        .modal-footer p {
            color: var(--text-light);
            font-size: 0.95rem;
        }

        .modal-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
        }

        .modal-footer a:hover {
            text-decoration: underline;
        }

        /* Responsive Design */
        @media (max-width: 968px) {
            .hero h1 {
                font-size: 2.2rem;
            }

            .benefits-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .steps-container {
                grid-template-columns: repeat(2, 1fr);
                gap: 30px;
            }

            .feature-block {
                grid-template-columns: 1fr;
                gap: 40px;
            }

            .nav-buttons {
                flex-direction: column;
                width: 100%;
            }

            .nav-container {
                flex-direction: column;
                gap: 20px;
            }
        }

        @media (max-width: 640px) {
            .hero {
                padding: 60px 20px;
            }

            .hero h1 {
                font-size: 1.8rem;
            }

            .how-it-works h2,
            .get-started h2 {
                font-size: 1.8rem;
            }

            .steps-container {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 20px;
                padding: 30px 20px;
            }

            .footer-links {
                flex-direction: column;
                gap: 15px;
            }
        }

        /* Loading State */
        button.loading {
            position: relative;
            color: transparent;
            pointer-events: none;
        }

        button.loading::after {
            content: "";
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 3px solid white;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            background: #FFF3F3;
            color: var(--danger);
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            border-left: 4px solid var(--danger);
        }

        .success-message {
            background: #F0F9F4;
            color: var(--success);
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            border-left: 4px solid var(--success);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <div class="logo">
                <span class="logo-icon">üåô</span>
                <span>Noctural</span>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline" onclick="openLoginModal()">Login</button>
                <button class="btn btn-primary" onclick="openRegisterModal()">Get Started</button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>it's time for something better</h1>

            <div class="benefits-grid">
                <div class="benefits-column">
                    <h3>For Healthcare Professionals</h3>
                    <ul>
                        <li>be your own boss & take back control</li>
                        <li>set your rates, preferences & choose the shifts that suit you</li>
                        <li>say goodbye to time-consuming admin, paper timesheets & agency mistakes</li>
                    </ul>
                </div>
                <div class="benefits-column">
                    <h3>For Healthcare Facilities</h3>
                    <ul>
                        <li>keep your digital profile & compliance up-to-date and secure</li>
                        <li>one-click apply to hundreds of shifts across the country</li>
                        <li>get paid on time, every time - timesheets submitted, tracked & approved online</li>
                    </ul>
                </div>
            </div>

            <div class="mission-statement">
                <p>Our online marketplace directly connects primary and urgent care professionals with service providers and shifts without the need for recruitment agencies.</p>
                <p>We give power back to healthcare professionals by cutting out recruiters and exploitative agency fees.</p>
            </div>

            <div class="cta-button">
                <button class="btn btn-primary btn-lg" onclick="openRegisterModal()" style="font-size: 1.1rem; padding: 15px 40px;">find out more</button>
            </div>
        </div>
    </section>

    <!-- How It Works Section -->
    <section class="how-it-works">
        <h2>how it works</h2>
        <div class="steps-container">
            <div class="step">
                <div class="step-icon">üë§</div>
                <h3>Create Your Profile</h3>
                <p>Sign up and build your professional profile with your experience, skills and credentials</p>
            </div>
            <div class="step">
                <div class="step-icon">üì±</div>
                <h3>Browse & Apply</h3>
                <p>Find shifts that match your preferences and apply with just one click</p>
            </div>
            <div class="step">
                <div class="step-icon">üíº</div>
                <h3>Get Hired</h3>
                <p>Facilities review your profile and accept your application for the perfect match</p>
            </div>
            <div class="step">
                <div class="step-icon">üí∞</div>
                <h3>Get Paid</h3>
                <p>Complete your shift and receive payment directly - no middleman, no delays</p>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features">
        <div class="features-container">
            <div class="feature-block">
                <div class="feature-content">
                    <h3>Sing your own praises.</h3>
                    <p>Tell service providers about your experience, skills and professional interests directly, with no unnecessary middle-man.</p>
                </div>
                <div class="feature-visual">
                    <div class="feature-visual-content">üìã</div>
                </div>
            </div>

            <div class="feature-block" style="direction: rtl;">
                <div class="feature-content" style="direction: ltr;">
                    <h3>Have control.</h3>
                    <p>Agree your own shifts and rates of pay based on your preferences and availability.</p>
                </div>
                <div class="feature-visual">
                    <div class="feature-visual-content">üéØ</div>
                </div>
            </div>

            <div class="feature-block">
                <div class="feature-content">
                    <h3>Earn more.</h3>
                    <p>No more agencies means you receive <span class="highlight">100% of your agreed rate</span> - up to <span class="highlight">20% more</span> than you would with an agency.</p>
                </div>
                <div class="feature-visual">
                    <div class="feature-visual-content">üí∏</div>
                </div>
            </div>

            <div class="quote-section">
                <h2>"turbo-charging a digital revolution within healthcare staffing"</h2>
                <p>‚Äî Digital Innovation Director</p>
            </div>

            <div class="feature-block" style="direction: rtl;">
                <div class="feature-content" style="direction: ltr;">
                    <h3>simple and easy to use on any device</h3>
                    <p>We connect healthcare professionals with regular, high-paying work via our <span class="highlight">transparent</span> and <span class="highlight">easy to use</span> platform</p>
                    <p>Find shifts that are <span class="highlight">perfect</span> for you in just a few clicks</p>
                    <p>Forget paper timesheets - hours worked are auto-approved and submitted for payment <span class="highlight">instantly</span> so you always get paid on time</p>
                </div>
                <div class="feature-visual">
                    <div class="feature-visual-content">üì≤</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Get Started Section -->
    <section class="get-started">
        <div class="get-started-content">
            <h2>get started</h2>
            <div class="requirements">
                <p>To find and book shifts with Noctural you must be allowed to work in the UK, have worked as a GP or registered Nurse (RGN or RMN) for at least one year and have up-to-date documents.</p>
            </div>
            <p style="font-weight: 600; margin-top: 30px;">that's it.</p>
            <p style="margin-top: 20px;">Noctural has nationwide coverage and is working with many of the best known primary and urgent care providers, GP federations, social care providers and care homes in both the NHS and private sector.</p>
            <p class="bold-text">got all your documentation to hand? you can start booking shifts today.</p>
            <button class="btn btn-primary btn-lg" onclick="openRegisterModal()" style="font-size: 1.1rem; padding: 15px 40px; margin-top: 20px;">get started</button>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="social-links">
            <a href="#" title="Facebook">üìò</a>
            <a href="#" title="LinkedIn">üíº</a>
            <a href="#" title="Twitter">üê¶</a>
        </div>
        <div class="footer-links">
            <a href="#" onclick="alert('Help Center coming soon'); return false;">HELP CENTER</a>
            <a href="#" onclick="alert('Careers page coming soon'); return false;">CAREERS</a>
            <a href="#" onclick="alert('Privacy Policy coming soon'); return false;">PRIVACY</a>
            <a href="#" onclick="alert('Terms of Use coming soon'); return false;">TERMS OF USE</a>
            <a href="#" onclick="alert('Contact page coming soon'); return false;">CONTACT</a>
        </div>
        <p style="margin-top: 20px;">&copy; 2025 Noctural. All rights reserved.</p>
    </footer>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeLoginModal()">&times;</button>
            <h2>Welcome Back</h2>
            <div id="loginError"></div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="btn btn-primary">Login</button>
            </form>
            <div class="modal-footer">
                <p>Don't have an account? <a onclick="closeLoginModal(); openRegisterModal();">Sign up</a></p>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeRegisterModal()">&times;</button>
            <h2>Get Started</h2>
            <div id="registerError"></div>
            <form id="registerForm">
                <div class="form-group">
                    <label for="registerName">Full Name</label>
                    <input type="text" id="registerName" required>
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" required minlength="6">
                </div>
                <div class="form-group">
                    <label for="registerRole">I am a...</label>
                    <select id="registerRole" required>
                        <option value="">Select your role</option>
                        <option value="doctor">Doctor / GP</option>
                        <option value="nurse">Nurse (RGN/RMN)</option>
                        <option value="admin">Hospital Administrator</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Create Account</button>
            </form>
            <div class="modal-footer">
                <p>Already have an account? <a onclick="closeRegisterModal(); openLoginModal();">Login</a></p>
            </div>
        </div>
    </div>

    <!-- JWT-based Authentication (Firebase removed for security) -->
    <script>
        // Check if user is already logged in
        window.addEventListener('DOMContentLoaded', async () => {
            const token = localStorage.getItem('token');
            if (token) {
                try {
                    // Verify token with backend
                    const response = await fetch('http://localhost:5000/api/auth/me', {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    const data = await response.json();

                    if (data.success && data.user) {
                        const userData = data.user;
                        localStorage.setItem('user', JSON.stringify(userData));

                        if (userData.role === 'doctor' || userData.role === 'nurse') {
                            if (userData.onboardingCompleted) {
                                window.location.href = 'doctor-dashboard.html';
                            } else {
                                window.location.href = 'doctor-onboarding.html';
                            }
                        } else if (userData.role === 'admin') {
                            window.location.href = 'admin-dashboard.html';
                        }
                    } else {
                        // Token invalid, clear it
                        localStorage.removeItem('token');
                        localStorage.removeItem('user');
                    }
                } catch (error) {
                    console.log('No valid session');
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                }
            }
        });

        // Login Form Handler
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button[type="submit"]');
            const errorDiv = document.getElementById('loginError');
            errorDiv.innerHTML = '';

            btn.classList.add('loading');

            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            try {
                // Login using secure JWT-based backend API
                const response = await fetch('http://localhost:5000/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();

                if (data.success && data.token) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data.user));

                    if (data.user.role === 'doctor' || data.user.role === 'nurse') {
                        localStorage.setItem('userType', 'doctor');
                        // Check if onboarding is completed
                        if (data.user.onboardingCompleted) {
                            window.location.href = 'doctor-dashboard.html';
                        } else {
                            window.location.href = 'doctor-onboarding.html';
                        }
                    } else if (data.user.role === 'admin') {
                        localStorage.setItem('userType', 'hospital');
                        window.location.href = 'admin-dashboard.html';
                    }
                } else {
                    throw new Error(data.message || 'Login failed');
                }
            } catch (error) {
                console.error('Login error:', error);
                errorDiv.innerHTML = '<div class="error-message">Invalid email or password. Please try again.</div>';
                btn.classList.remove('loading');
            }
        });

        // Register Form Handler
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button[type="submit"]');
            const errorDiv = document.getElementById('registerError');
            errorDiv.innerHTML = '';

            btn.classList.add('loading');

            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const role = document.getElementById('registerRole').value;

            try {
                // Register using secure JWT-based backend API
                const response = await fetch('http://localhost:5000/api/auth/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, password, role })
                });

                const data = await response.json();

                if (data.success && data.token) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data.user));

                    if (role === 'doctor' || role === 'nurse') {
                        localStorage.setItem('userType', 'doctor');
                        window.location.href = 'doctor-onboarding.html';
                    } else if (role === 'admin') {
                        localStorage.setItem('userType', 'hospital');
                        window.location.href = 'admin-dashboard.html';
                    }
                } else {
                    throw new Error(data.message || 'Registration failed');
                }
            } catch (error) {
                console.error('Registration error:', error);
                let errorMessage = 'Registration failed. Please try again.';
                if (error.message && error.message.includes('already exists')) {
                    errorMessage = 'This email is already registered. Please login instead.';
                } else if (error.message && error.message.includes('password')) {
                    errorMessage = 'Password must be at least 8 characters with uppercase, lowercase, number, and special character.';
                }
                errorDiv.innerHTML = `<div class="error-message">${errorMessage}</div>`;
                btn.classList.remove('loading');
            }
        });
    </script>

    <script>
        // Modal Functions
        function openLoginModal() {
            document.getElementById('loginModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            document.getElementById('loginError').innerHTML = '';
        }

        function openRegisterModal() {
            // Redirect to unified landing page for registration
            window.location.href = 'index-unified.html';
        }

        function closeRegisterModal() {
            document.getElementById('registerModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            document.getElementById('registerError').innerHTML = '';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const loginModal = document.getElementById('loginModal');
            const registerModal = document.getElementById('registerModal');
            if (event.target === loginModal) {
                closeLoginModal();
            }
            if (event.target === registerModal) {
                closeRegisterModal();
            }
        }
    </script>
</body>
</html>
